From eee97cbf456410c0a37a0e1cb4f7cacc6fb0d906 Mon Sep 17 00:00:00 2001
From: Tad <tad@spotco.us>
Date: Wed, 17 Feb 2021 12:49:10 -0500
Subject: [PATCH] kernel: generic 5.10: config hardening

Enables various security options.
Disables various high-risk bits.

Signed-off-by: Tad <tad@spotco.us>
---
 target/linux/generic/config-5.10 | 125 +++++++++++++++++++++++++++++++
 1 file changed, 125 insertions(+)

diff --git a/target/linux/generic/config-5.10 b/target/linux/generic/config-5.10
index c15829e49e..71b9ef36fc 100644
--- a/target/linux/generic/config-5.10
+++ b/target/linux/generic/config-5.10
@@ -7087,3 +7087,128 @@ CONFIG_ZONE_DMA=y
 # CONFIG_ZRAM_MEMORY_TRACKING is not set
 # CONFIG_ZSMALLOC is not set
 # CONFIG_ZX_TDM is not set
+CONFIG_ARM64_PTR_AUTH=y
+CONFIG_ARM64_SW_TTBR0_PAN=y
+CONFIG_ARM64_UAO=y
+CONFIG_BUG=y
+CONFIG_BUG_ON_DATA_CORRUPTION=y
+CONFIG_CC_STACKPROTECTOR_STRONG=y
+CONFIG_CPU_SW_DOMAIN_PAN=y
+CONFIG_DEBUG_CREDENTIALS=y
+CONFIG_DEBUG_KERNEL=y
+CONFIG_DEBUG_LIST=y
+CONFIG_DEBUG_NOTIFIERS=y
+CONFIG_DEBUG_RODATA=y
+CONFIG_DEBUG_SET_MODULE_RONX=y
+CONFIG_DEBUG_SG=y
+CONFIG_DEBUG_VIRTUAL=y
+CONFIG_DEBUG_WX=y
+CONFIG_FORTIFY_SOURCE=y
+CONFIG_HARDEN_BRANCH_PREDICTOR=y
+CONFIG_HARDENED_USERCOPY=y
+CONFIG_HARDEN_EL2_VECTORS=y
+CONFIG_INIT_ON_ALLOC_DEFAULT_ON=y
+CONFIG_INIT_ON_FREE_DEFAULT_ON=y
+CONFIG_INIT_STACK_ALL=y
+CONFIG_INIT_STACK_ALL_ZERO=y
+CONFIG_IO_STRICT_DEVMEM=y
+CONFIG_IPV6_PRIVACY=y
+CONFIG_KAISER=y
+CONFIG_KGSL_PER_PROCESS_PAGE_TABLE=y
+CONFIG_LEGACY_VSYSCALL_NONE=y
+CONFIG_MMC_SECDISCARD=y
+CONFIG_PAGE_POISONING=y
+CONFIG_PAGE_POISONING_NO_SANITY=y
+CONFIG_PAGE_POISONING_ZERO=y
+CONFIG_PAGE_TABLE_ISOLATION=y
+CONFIG_PANIC_ON_OOPS=y
+CONFIG_RANDOMIZE_BASE=y
+CONFIG_RANDOMIZE_MEMORY=y
+CONFIG_REFCOUNT_FULL=y
+CONFIG_RETPOLINE=y
+CONFIG_RODATA_FULL_DEFAULT_ENABLED=y
+CONFIG_SCHED_STACK_END_CHECK=y
+CONFIG_SECCOMP=y
+CONFIG_SECCOMP_FILTER=y
+CONFIG_SECURITY=y
+CONFIG_SECURITY_DMESG_RESTRICT=y
+CONFIG_SECURITY_PERF_EVENTS_RESTRICT=y
+CONFIG_SECURITY_YAMA=y
+CONFIG_SECURITY_YAMA_STACKED=y
+CONFIG_SHUFFLE_PAGE_ALLOCATOR=y
+CONFIG_SLAB_FREELIST_HARDENED=y
+CONFIG_SLAB_FREELIST_RANDOM=y
+CONFIG_SLAB_HARDENED=y
+CONFIG_SLUB_HARDENED=y
+CONFIG_STACKPROTECTOR_PER_TASK=y
+CONFIG_STACKPROTECTOR_STRONG=y
+CONFIG_STATIC_USERMODEHELPER=y
+CONFIG_STRICT_DEVMEM=y
+CONFIG_STRICT_KERNEL_RWX=y
+CONFIG_STRICT_MEMORY_RWX=y
+CONFIG_STRICT_MODULE_RWX=y
+CONFIG_SYN_COOKIES=y
+CONFIG_THREAD_INFO_IN_TASK=y
+CONFIG_UNMAP_KERNEL_AT_EL0=y
+CONFIG_VMAP_STACK=y
+CONFIG_ACPI_APEI_EINJ=n
+CONFIG_ACPI_CUSTOM_METHOD=n
+CONFIG_ACPI_TABLE_UPGRADE=n
+CONFIG_BINFMT_AOUT=n
+CONFIG_BINFMT_MISC=n
+CONFIG_BT_HS=n
+CONFIG_CHECKPOINT_RESTORE=n
+CONFIG_COMPAT_BRK=n
+CONFIG_COMPAT_VDSO=n
+CONFIG_CP_ACCESS64=n
+CONFIG_DEBUG_KMEMLEAK=n
+CONFIG_DEVKMEM=n
+CONFIG_DEVMEM=n
+CONFIG_DEVPORT=n
+CONFIG_EARJACK_DEBUGGER=n
+CONFIG_HARDENED_USERCOPY_FALLBACK=n
+CONFIG_HIBERNATION=n
+CONFIG_HWPOISON_INJECT=n
+CONFIG_IA32_EMULATION=n
+CONFIG_IOMMU_NON_SECURE=n
+CONFIG_INPUT_EVBUG=n
+CONFIG_IP_DCCP=n
+CONFIG_IP_SCTP=n
+CONFIG_KEXEC=n
+CONFIG_KEXEC_FILE=n
+CONFIG_KSM=n
+CONFIG_LDISC_AUTOLOAD=n
+CONFIG_LEGACY_PTYS=n
+CONFIG_LIVEPATCH=n
+CONFIG_MEM_SOFT_DIRTY=n
+CONFIG_MMIOTRACE=n
+CONFIG_MMIOTRACE_TEST=n
+CONFIG_MODIFY_LDT_SYSCALL=n
+CONFIG_MSM_BUSPM_DEV=n
+CONFIG_NEEDS_SYSCALL_FOR_CMPXCHG=n
+CONFIG_NOTIFIER_ERROR_INJECTION=n
+CONFIG_OABI_COMPAT=n
+CONFIG_PAGE_OWNER=n
+CONFIG_PROC_KCORE=n
+CONFIG_PROC_PAGE_MONITOR=n
+CONFIG_PROC_VMCORE=n
+CONFIG_RDS=n
+CONFIG_RDS_TCP=n
+CONFIG_SECURITY_SELINUX_DISABLE=n
+CONFIG_SECURITY_WRITABLE_HOOKS=n
+CONFIG_SLAB_MERGE_DEFAULT=n
+CONFIG_STACKLEAK_METRICS=n
+CONFIG_STACKLEAK_RUNTIME_DISABLE=n
+CONFIG_TIMER_STATS=n
+CONFIG_TSC=n
+CONFIG_TSPP2=n
+CONFIG_UKSM=n
+CONFIG_UPROBES=n
+CONFIG_USELIB=n
+CONFIG_USERFAULTFD=n
+CONFIG_VIDEO_VIVID=n
+CONFIG_WLAN_FEATURE_MEMDUMP=n
+CONFIG_X86_IOPL_IOPERM=n
+CONFIG_X86_PTDUMP=n
+CONFIG_X86_VSYSCALL_EMULATION=n
+CONFIG_ZSMALLOC_STAT=n
-- 
2.31.1

